"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var key_alphabet_1 = require("./key-alphabet");
var text_random_string_1 = require("./text-random-string");
var lastTimestamp = 0;
function key(timestamp, as) {
    if (timestamp === undefined) {
        timestamp = Date.now();
        if (timestamp <= lastTimestamp) {
            timestamp = lastTimestamp + 1;
        }
        lastTimestamp = timestamp;
    }
    if (timestamp instanceof Date) {
        timestamp = timestamp.getTime();
    }
    var result = new Array(9);
    for (var i = 7; i >= 0; --i) {
        result[i] = key_alphabet_1.alphabet.charAt(timestamp % 64);
        timestamp = Math.floor(timestamp / 64);
    }
    if (timestamp !== 0) {
        throw new Error("Unexpected timestamp.");
    }
    switch (as) {
        case "max":
            result[8] = "zzzzzzzzzzzz";
            break;
        case "min":
            result[8] = "------------";
            break;
        default:
            result[8] = text_random_string_1.randomString(key_alphabet_1.alphabet, 12);
    }
    return result.join("");
}
exports.key = key;
function resetLastTimestamp() {
    lastTimestamp = 0;
}
exports.resetLastTimestamp = resetLastTimestamp;
